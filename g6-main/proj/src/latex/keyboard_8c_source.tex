\doxysection{keyboard.\+c}
\hypertarget{keyboard_8c_source}{}\label{keyboard_8c_source}\index{devices/keyboard.c@{devices/keyboard.c}}
\mbox{\hyperlink{keyboard_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{keyboard_8h}{keyboard.h}}"{}}}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00004}\mbox{\hyperlink{keyboard_8c_ae5d71bd9d53577890ce705d0b488b6ee}{00004}}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{keyboard_8c_ae5d71bd9d53577890ce705d0b488b6ee}{keys}}[0x90];}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00006}\mbox{\hyperlink{keyboard_8c_a74708534432e98d4ab30ba40e2e5dcc3}{00006}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{keyboard_8c_a74708534432e98d4ab30ba40e2e5dcc3}{kbd\_hook\_id}}\ =\ 1;}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00007}\mbox{\hyperlink{keyboard_8c_a4ac9231a99a664d6a9f0b69767e0d707}{00007}}\ int\ (\mbox{\hyperlink{keyboard_8c_a4ac9231a99a664d6a9f0b69767e0d707}{kbd\_subscribe\_int}})(uint8\_t*\ bit\_no)\{}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00008}00008\ \ \ \ \ *bit\_no\ =\ \mbox{\hyperlink{keyboard_8c_a74708534432e98d4ab30ba40e2e5dcc3}{kbd\_hook\_id}};}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00009}00009\ \ \ \ \ \textcolor{keywordflow}{return}\ sys\_irqsetpolicy(\mbox{\hyperlink{i8042_8h_a1862e728098ddeac91aaacf6420fc2e7}{KBD\_IRQ\_LINE}},IRQ\_REENABLE\ |\ IRQ\_EXCLUSIVE\ ,\ \&\mbox{\hyperlink{keyboard_8c_a74708534432e98d4ab30ba40e2e5dcc3}{kbd\_hook\_id}});}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00010}00010\ \}}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00012}\mbox{\hyperlink{keyboard_8c_aee0a7b54ee426fade9c780418d110fe0}{00012}}\ int\ (\mbox{\hyperlink{keyboard_8c_aee0a7b54ee426fade9c780418d110fe0}{kbd\_unsubscribe\_int}})()\{}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00013}00013\ \ \ \ \ \textcolor{keywordflow}{return}\ sys\_irqrmpolicy(\&\mbox{\hyperlink{keyboard_8c_a74708534432e98d4ab30ba40e2e5dcc3}{kbd\_hook\_id}});}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00014}00014\ \}}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00017}\mbox{\hyperlink{keyboard_8c_a06a3dd28ec493a423fea6ccd048d441a}{00017}}\ uint8\_t\ \mbox{\hyperlink{keyboard_8c_a06a3dd28ec493a423fea6ccd048d441a}{scan\_code}}[2];}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00018}\mbox{\hyperlink{keyboard_8c_a1304f6a4a1ca2e86ea8cf758c982e0e0}{00018}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{keyboard_8c_a1304f6a4a1ca2e86ea8cf758c982e0e0}{kbd\_i}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00019}\mbox{\hyperlink{keyboard_8c_add8f02ddb10d6c372aaecf63d33bcd66}{00019}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{keyboard_8c_add8f02ddb10d6c372aaecf63d33bcd66}{kbd\_ih\_flag}}=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00020}\mbox{\hyperlink{keyboard_8c_aea970a154161a35f6894898a092ed70a}{00020}}\ void\ (\mbox{\hyperlink{keyboard_8c_aea970a154161a35f6894898a092ed70a}{kbc\_ih}})()\{}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00021}00021\ \ \ uint8\_t\ output;}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00022}00022\ \ \ \mbox{\hyperlink{_k_b_c_8c_a72fbcf4ba83c3ea35461be5675a1277d}{KBC\_read\_output}}(\mbox{\hyperlink{i8042_8h_a4180e4977784e44dfa1bb52daa9b6d07}{KBC\_OUT\_BUFF}},\&output);}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00024}00024\ \ \ uint8\_t\ st;}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00025}00025\ \ \ \mbox{\hyperlink{_k_b_c_8c_a783c73c7acfacf481d616e56650195df}{KBC\_get\_status}}(\&st);}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00027}00027\ \ \ \textcolor{keywordflow}{if}\ (!(st\ \&\ (\mbox{\hyperlink{i8042_8h_a81d2ca6759f3f3bf04556b7558aea6bc}{PARITY\_ERROR}}\ |\ \mbox{\hyperlink{i8042_8h_aefc48d416c882f06edaf6d01779d4d74}{TIMEOUT\_ERROR}})))\ \{}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00028}00028\ \ \ \ \ \mbox{\hyperlink{keyboard_8c_a06a3dd28ec493a423fea6ccd048d441a}{scan\_code}}[\mbox{\hyperlink{keyboard_8c_a1304f6a4a1ca2e86ea8cf758c982e0e0}{kbd\_i}}]\ =\ output;}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{if}\ (output\ !=\ \mbox{\hyperlink{i8042_8h_ab427e6926fcc47eb1c02c1f78162b6f6}{TWO\_BYTES}})\ \{}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00031}00031\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (output\ \&\ BIT(7))\ \{}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00032}00032\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{keyboard_8c_add8f02ddb10d6c372aaecf63d33bcd66}{kbd\_ih\_flag}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00033}00033\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00034}00034\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{keyboard_8c_add8f02ddb10d6c372aaecf63d33bcd66}{kbd\_ih\_flag}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00035}00035\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00036}00036\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00038}00038\ \ \ \}}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00039}00039\ \}}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00041}\mbox{\hyperlink{keyboard_8c_ab2698b094b95ec9e2d4bc4a9076e32fe}{00041}}\ int\ (\mbox{\hyperlink{keyboard_8c_ab2698b094b95ec9e2d4bc4a9076e32fe}{kbd\_restore}})()\{}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00042}00042\ \ \ \ \ \mbox{\hyperlink{_k_b_c_8c_a95d45e37519eb9a678f9a4badf1482d3}{KBC\_write\_input}}(\mbox{\hyperlink{i8042_8h_a352e43b162f7755d7849e3c181d326c2}{COMMAND\_INTERACT}},\mbox{\hyperlink{i8042_8h_a595a5cad2d3c793963da50865b2c1b47}{KBC\_READ\_CMD}});}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00043}00043\ \ \ \ \ uint8\_t\ cmd\_byte;}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00044}00044\ \ \ \ \ \mbox{\hyperlink{_k_b_c_8c_a72fbcf4ba83c3ea35461be5675a1277d}{KBC\_read\_output}}(\mbox{\hyperlink{i8042_8h_a4180e4977784e44dfa1bb52daa9b6d07}{KBC\_OUT\_BUFF}},\&cmd\_byte);}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00045}00045\ \ \ \ \ cmd\_byte\ |=\ \mbox{\hyperlink{i8042_8h_a731d20e5ad149c23ad5840861bfb84b1}{KBD\_ENABLE\_OBF\_INT}};}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00046}00046\ \ \ \ \ \mbox{\hyperlink{_k_b_c_8c_a95d45e37519eb9a678f9a4badf1482d3}{KBC\_write\_input}}(\mbox{\hyperlink{i8042_8h_a352e43b162f7755d7849e3c181d326c2}{COMMAND\_INTERACT}},\ \mbox{\hyperlink{i8042_8h_aaa62a6987753a109d2f7a609ce8b7334}{KBC\_WRITE\_CMD}});}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00047}00047\ \ \ \ \ \mbox{\hyperlink{_k_b_c_8c_a95d45e37519eb9a678f9a4badf1482d3}{KBC\_write\_input}}(\mbox{\hyperlink{i8042_8h_a99533c5d88176d018fa5a725dbd2f4a3}{KBC\_IN\_BUFF}}\ ,\ cmd\_byte);}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00048}00048\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{keyboard_8c_source_l00049}00049\ \}}

\end{DoxyCode}
